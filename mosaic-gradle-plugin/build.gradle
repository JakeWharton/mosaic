apply plugin: 'org.jetbrains.kotlin.jvm'
apply plugin: 'java-gradle-plugin'
apply plugin: 'com.vanniktech.maven.publish'
apply plugin: 'com.github.gmazzo.buildconfig'

dependencies {
	compileOnly gradleApi()
	compileOnly libs.kotlin.gradlePlugin

	testImplementation libs.junit4
	testImplementation libs.truth
	testImplementation gradleTestKit()
}

gradlePlugin {
	plugins {
		mosaic {
			id = "com.jakewharton.mosaic"
			displayName = "Mosaic"
			description = "Jetpack Compose for console UI"
			implementationClass = "com.jakewharton.mosaic.gradle.MosaicPlugin"
		}
	}
}

test {
	dependsOn(':mosaic-gradle-plugin:installArchives')
	dependsOn(':mosaic-runtime:installArchives')
}

buildConfig {
	useKotlinOutput {
		internalVisibility = true
		topLevelConstants = true
	}

	packageName('com.jakewharton.mosaic.gradle')
	buildConfigField("String", "composeCompilerVersion", "\"${libs.versions.androidx.compose.compiler.get()}\"")
	buildConfigField("String", "mosaicVersion", "\"${project.version}\"")
}
